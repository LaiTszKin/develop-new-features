# Property-based 測試原則

## 目的
- 驗證「不變量/性質」在廣泛輸入下皆成立。
- 捕捉單元測試難以覆蓋的組合或邊界情境。

## 使用時機
- 演算法、轉換、序列化/反序列化、排序或聚合邏輯。
- 需要保證一致性或可逆性的行為（例如 round-trip）。
- 具有明確不變量的資料結構或狀態轉換。

## 不適用情境
- 依賴外部系統或 IO 的行為（改用整合測試）。
- 不具穩定不變量的 UI/互動流程。
- 極小的離散輸入集合（使用單元測試即可）。

## 設計要點
- 不變量需清楚、可被機器驗證（例如：排序後維持遞增）。
- 生成策略需涵蓋邊界與極端值，避免只生成平均值。
- 確保可重現：固定種子或允許重跑時輸入可重現。
- 與單元測試互補：避免重複測同一組固定案例。
- 控制成本：設定合理的樣本數與輸入大小上限。

## 常見不變量範例（描述層級即可）
- 反序列化(序列化(x)) == x。
- 排序結果維持遞增，且元素集合不變。
- 合併/拆分後元素數量守恆。
- 冪等性：同一操作重複執行結果不變。

## PRD 填寫指引
- 性質/不變量：用一句話描述必須永遠成立的規則。
- 生成策略：描述輸入的範圍、分佈與特別關注的邊界。
- 目的：說明此不變量對系統正確性的貢獻或風險降低。
