# 單元測試原則

## 目的
- 驗證最小可測單元的正確性（函式、方法或純邏輯模組）。
- 快速回饋、低成本定位錯誤。

## 使用時機
- 核心業務邏輯與關鍵分支。
- 邊界條件（上下限、空值、極端值）。
- 錯誤處理或例外路徑（如輸入無效、狀態不符）。

## 不適用情境
- 需跨模組或外部依賴驗證的行為（改用整合測試）。
- 需要完整使用者流程驗證（僅在使用者要求時採用 E2E）。

## 設計要點
- 隔離外部依賴：使用 mock/stub/fake，避免 DB、RPC、檔案 IO。
- 保持測試小而精：一個測試聚焦單一行為或單一失敗模式。
- 覆蓋條件分支：正常路徑與失敗路徑都要覆蓋。
- 保持可重現：避免時間、隨機或全域狀態干擾。
- 以需求為導向：每條核心需求至少有一個單元測試對應。

## PRD 填寫指引
- 情境：描述輸入與初始狀態，對應單一需求或邊界。
- 期望結果：可驗證的輸出、狀態改變或錯誤。
- 目的：說明要防止的風險或錯誤型態。

## 常見範例（描述層級即可）
- 輸入超出允許範圍時回傳特定錯誤。
- 空集合/空字串輸入時，行為符合預期（例如回傳空結果）。
- 旗標或狀態切換後，輸出符合定義。
