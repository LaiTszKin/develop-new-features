# 整合測試原則

## 目的
- 驗證跨模組、跨層或外部依賴的行為是否正確協作。
- 覆蓋單元測試無法捕捉的整合風險（序列、配置、IO 失敗）。

## 使用時機
- 模組間介面互動（例如 service ↔ repository）。
- 涉及 DB、RPC、檔案、快取、訊息佇列等 IO 依賴。
- 需要驗證設定組合或環境差異的行為。

## 不適用情境
- 單一純函式或純邏輯行為（用單元測試）。
- 完整端到端流程（除非使用者要求 E2E）。

## 設計要點
- 聚焦關鍵整合點：每個測試都要能說明風險與價值。
- 控制依賴範圍：必要時使用測試替身或本地 stub。
- 保持可重現：測試資料可控、環境可復原。
- 故障模式覆蓋：包含超時、連線失敗、資料不一致等情境。
- 成本可控：避免大量重複或全面覆蓋（交給單元測試）。

## PRD 填寫指引
- 依賴/範圍：列出涉及的模組或外部系統。
- 情境：描述跨模組互動的流程或關鍵分支。
- 目的：說明整合風險、失敗模式或配置風險。
- 若不需要：填「無」並說明原因（例如：無跨模組互動）。
